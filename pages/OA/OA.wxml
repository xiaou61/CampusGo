<!--pages/OA/OA.wxml-->
<view class="header">
    <view class="header-title">ç§»åŠ¨ OA ç³»ç»Ÿ</view>
    <view class="notification-btn" bindtap="showNotificationPanel">ğŸ””</view>
    <view class="header-user">
        <text>{{userInfo.name}}</text>
        <image src="{{userInfo.avatar}}" mode="aspectFill"></image>
    </view>
</view>

<view class="container-OA">
    <view class="card">
        <view class="card-body">
            <view class="quick-actions">
                <view class="quick-action-item" bindtap="navigateToApproval">
                    <view class="quick-action-icon">ğŸ“</view>
                    <view class="quick-action-text">å®¡æ‰¹</view>
                </view>
                <view class="quick-action-item" bindtap="navigateToSchedule">
                    <view class="quick-action-icon">ğŸ“…</view>
                    <view class="quick-action-text">æ—¥ç¨‹</view>
                </view>
                <view class="quick-action-item" bindtap="navigateToReport">
                    <view class="quick-action-icon">ğŸ“Š</view>
                    <view class="quick-action-text">æŠ¥è¡¨</view>
                </view>
                <view class="quick-action-item" bindtap="navigateToDocument">
                    <view class="quick-action-icon">ğŸ“</view>
                    <view class="quick-action-text">æ–‡æ¡£</view>
                </view>
                <view class="quick-action-item" bindtap="navigateToContacts">
                    <view class="quick-action-icon">ğŸ‘¥</view>
                    <view class="quick-action-text">é€šè®¯å½•</view>
                </view>
                <view class="quick-action-item" bindtap="navigateToAnnouncement">
                    <view class="quick-action-icon">ğŸ””</view>
                    <view class="quick-action-text">å…¬å‘Š</view>
                </view>
                <view class="quick-action-item" bindtap="navigateToExam">
                    <view class="quick-action-icon">k</view>
                    <view class="quick-action-text">è€ƒè¯•</view>
                </view>
                <view class="quick-action-item" bindtap="navigateToMore">
                    <view class="quick-action-icon">âš™ï¸</view>
                    <view class="quick-action-text">æ›´å¤š</view>
                </view>
            </view>
        </view>
    </view>

    <view class="card">
        <view class="card-header">
            <text>å¾…åŠä»»åŠ¡</text>
            <text class="more-link" bindtap="navigateToMoreTasks">æ›´å¤š</text>
        </view>
        <view class="card-body">
            <view class="task-list">
                <view class="task-item" wx:for="{{tasks}}" wx:key="id" bindtap="viewTaskDetail" data-id="{{item.id}}">
                    <view class="task-status status-{{item.priority}}"></view>
                    <view class="task-content">
                        <view class="task-title">{{item.title}}</view>
                        <view class="task-info">
                            <text>æˆªæ­¢æ—¥æœŸ: {{item.deadline}}</text>
                            <text>{{item.department}}</text>
                        </view>
                    </view>
                </view>
            </view>
        </view>
    </view>

    <view class="card">
        <view class="card-header">
            <text>æ—¥ç¨‹å®‰æ’</text>
            <text class="more-link" bindtap="navigateToMoreSchedule">æ›´å¤š</text>
        </view>
        <view class="card-body">
            <view class="calendar-header">
                <text wx:for="{{weekDays}}" wx:key="*this">{{item}}</text>
            </view>
            <view class="calendar">
                <view class="calendar-day {{item.isToday ? 'today' : ''}} {{item.hasEvent ? 'has-event' : ''}}" 
                      wx:for="{{calendarDays}}" 
                      wx:key="date"
                      bindtap="viewDaySchedule"
                      data-date="{{item.date}}">
                    {{item.day}}
                </view>
            </view>
            <view class="today-schedule" wx:if="{{todaySchedule.length > 0}}">
                <view class="task-item" wx:for="{{todaySchedule}}" wx:key="id" bindtap="viewScheduleDetail" data-id="{{item.id}}">
                    <view class="task-status status-{{item.priority}}"></view>
                    <view class="task-content">
                        <view class="task-title">{{item.title}}</view>
                        <view class="task-info">
                            <text>{{item.time}}</text>
                            <text>{{item.location}}</text>
                        </view>
                    </view>
                </view>
            </view>
        </view>
    </view>

    <view class="card">
        <view class="card-header">
            <text>é€šçŸ¥æ¶ˆæ¯</text>
            <text class="more-link" bindtap="navigateToMoreMessages">æ›´å¤š</text>
        </view>
        <view class="card-body">
            <view class="message-list">
                <view class="message-item {{item.unread ? 'message-unread' : ''}}" 
                      wx:for="{{messages}}" 
                      wx:key="id"
                      bindtap="viewMessageDetail"
                      data-id="{{item.id}}">
                    <view class="message-avatar">
                        <image src="{{item.avatar}}" mode="aspectFill"></image>
                    </view>
                    <view class="message-content">
                        <view class="message-header">
                            <text class="message-sender">{{item.sender}}</text>
                            <text class="message-time">{{item.time}}</text>
                        </view>
                        <view class="message-text">{{item.content}}</view>
                    </view>
                </view>
            </view>
            <view class="load-more" bindtap="loadMoreMessages" wx:if="{{hasMoreMessages}}">åŠ è½½æ›´å¤š</view>
        </view>
    </view>
</view>

<view class="notification-panel {{showNotificationPanel ? 'active' : ''}}">
    <view class="notification-header">
        <view class="notification-title">é€šçŸ¥ä¸­å¿ƒ</view>
        <view class="notification-close" bindtap="hideNotificationPanel">âœ•</view>
    </view>
    <view class="notification-content">
        <view class="message-list">
            <view class="message-item {{item.unread ? 'message-unread' : ''}}" 
                  wx:for="{{notifications}}" 
                  wx:key="id"
                  bindtap="viewNotificationDetail"
                  data-id="{{item.id}}">
                <view class="message-avatar">
                    <image src="{{item.avatar}}" mode="aspectFill"></image>
                </view>
                <view class="message-content">
                    <view class="message-header">
                        <text class="message-sender">{{item.sender}}</text>
                        <text class="message-time">{{item.time}}</text>
                    </view>
                    <view class="message-text">{{item.content}}</view>
                </view>
            </view>
        </view>
    </view>
    <view class="notification-footer">
        <button class="notification-clear" bindtap="clearAllNotifications">æ¸…é™¤æ‰€æœ‰é€šçŸ¥</button>
    </view>
</view>

<view class="overlay {{showNotificationPanel ? 'active' : ''}}" bindtap="hideNotificationPanel"></view>

<view class="toast {{showToast ? 'show' : ''}}">
    <view class="toast-icon">ğŸ””</view>
    <view class="toast-message">{{toastMessage}}</view>
</view>